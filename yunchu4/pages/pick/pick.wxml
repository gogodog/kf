<!-- 选配页面 -->
<cu-custom model="nav" bgColor="bg-red" isBack="{{true}}" isCustom="{{false}}">
  <view slot="backText">返回</view>
  <text slot="content">{{isEdit? editName :'创建菜谱'}}</text>
</cu-custom>
<scroll-view scroll-y class="DrawerPage {{sseasoning_visible || sfood_visible || sassistfood_visible?'show':''}}">
  <wux-notice-bar loop>{{"👋&nbsp ==> "+noticecontent}}</wux-notice-bar>
  <view class="cu-bar bg-white solid-bottom">
    <view class="action">
      <text class="cuIcon-title text-orange "></text>
      主料
    </view>
    <view class="action">
      <button class="cu-btn line-red" style="height:50rpx" bindtap="showModal" data-target="foodSearch">
        添加
      </button>
    </view>
  </view>
  <view class="cu-list menu">
    <block wx:if="{{content_food.length > 0}}">
      <view wx:for="{{content_food}}" wx:key="id" class="cu-item {{modalName1=='move-box-'+ index?'move-cur':''}}" wx:key="index" bindtouchstart="ListTouchStart1" bindtouchmove="ListTouchMove1" bindtouchend="ListTouchEnd1" data-target="move-box-{{index}}">
        <view class="cu-avatar radius lg" style="margin-top: 10rpx;margin-bottom: 10rpx;margin-right: 20rpx;background-image:url({{item.avatar}});"></view>
        <view class="content">
          <view class="text-grey">{{item.cnname}}</view>
        </view>
        <view class="action">
          <wux-input-number default-value="{{item.weightval}}" min="0" max="200" longpress disabled="{{ false }}" slot="footer" data-rowid="{{item.id}}" bind:change="changeFoodWeightval" />
        </view>
        <view class="move" data-id="{{item.id}}" bindtap="operateDelFood">
          <view class="bg-red">删除</view>
        </view>
      </view>
    </block>
    <view wx:if="{{content_food.length == 0}}" class="cu-item">
      <view class="content">
        <text class="cuIcon-edit text-green"></text>
        <text class="text-grey">点击按钮添加</text>
      </view>
    </view>
  </view>
  <view class="cu-bar bg-white solid-bottom margin-top">
    <view class="action">
      <text class="cuIcon-title text-orange "></text>
      辅料
    </view>
    <view class="action">
      <button class="cu-btn line-red" style="height:50rpx" bindtap="showModal" data-target="assistfoodSearch">添加</button>
    </view>
  </view>
  <view class="cu-list menu">
    <block wx:if="{{content_assistfood.length > 0}}">
      <view wx:for="{{content_assistfood}}" wx:key="id" class="cu-item {{modalName2=='move-box-'+ index?'move-cur':''}}" wx:key="index" bindtouchstart="ListTouchStart2" bindtouchmove="ListTouchMove2" bindtouchend="ListTouchEnd2" data-target="move-box-{{index}}">
        <view class="cu-avatar radius lg" style="margin-top: 10rpx;margin-bottom: 10rpx;margin-right: 20rpx;background-image:url({{item.avatar}});"></view>
        <view class="content">
          <view class="text-grey">{{item.cnname}}</view>
        </view>
        <view class="action">
          <wux-input-number default-value="{{item.weightval}}" min="0" max="200" longpress disabled="{{ false }}" slot="footer" data-rowid="{{item.id}}" bind:change="changeAssistFoodWeightval" />
        </view>
        <view class="move" data-id="{{item.id}}" bindtap="operateDelAssistFood">
          <view class="bg-red">删除</view>
        </view>
      </view>
    </block>
    <view wx:if="{{content_assistfood.length == 0}}" class="cu-item">
      <view class="content">
        <text class="cuIcon-edit text-green"></text>
        <text class="text-grey">点击按钮添加</text>
      </view>
    </view>
  </view>
  <view class="cu-bar bg-white solid-bottom margin-top">
    <view class="action">
      <text class="cuIcon-title text-orange "></text>
      调味品
    </view>
    <view class="action">
      <button class="cu-btn line-red" style="height:50rpx" bindtap="showModal" data-target="seasoningSearch">添加</button>
    </view>
  </view>
  <view class="cu-list menu">
    <block wx:if="{{content_seasoning.length > 0}}">
      <view wx:for="{{content_seasoning}}" wx:key="index" class="cu-item {{modalName3=='move-box-'+ index?'move-cur':''}}" wx:key="index" bindtouchstart="ListTouchStart3" bindtouchmove="ListTouchMove3" bindtouchend="ListTouchEnd3" data-target="move-box-{{index}}">
        <view class="cu-avatar radius lg" style="margin-top: 10rpx;margin-bottom: 10rpx;margin-right: 20rpx;background-image:url({{item.avatar}});"></view>
        <view class="content">
          <view class="text-grey">{{item.cnname}}</view>
        </view>
        <view class="action">
          <wux-input-number default-value="{{item.weightval}}" min="0" max="200" longpress disabled="{{ false }}" slot="footer" data-rowid="{{item.id}}" bind:change="changeSeasoningWeightval" />
        </view>
        <view class="move" data-id="{{item.id}}" bindtap="operateDelSeasoning">
          <view class="bg-red">删除</view>
        </view>
      </view>
    </block>
    <view wx:if="{{content_seasoning.length == 0}}" class="cu-item">
      <view class="content">
        <text class="cuIcon-edit text-green"></text>
        <text class="text-grey">点击按钮添加</text>
      </view>
    </view>
  </view>
  <view class="cu-bar bg-white solid-bottom margin-top">
    <view class="action">
      <text class="cuIcon-title text-orange "></text>
      做法
    </view>
  </view>
  <view class="cu-form-group">
    <textarea maxlength="-1" autoHeight bindinput="setContentMethod" value="{{content_method_catch}}" placeholder="请输入制作方法（建议每步使用换行隔开）"></textarea>
  </view>
  <view class="cu-bar bg-white solid-bottom margin-top">
    <view class="action">
      <text class="cuIcon-title text-orange "></text>
      需要注意
    </view>
  </view>
  <view class="cu-form-group">
    <textarea maxlength="-1" autoHeight bindinput="setContentAttion" value="{{content_attion_catch}}" placeholder="输入需要注意的事项"></textarea>
  </view>
  <view class='cu-btn bg-red lg block shadow radius margin-xl' style="margin-bottom: 200rpx" bindtap="submitPick">
    {{isEdit ? '保存':'提交'}}
  </view>
</scroll-view>
<view class="DrawerClose {{sseasoning_visible || sfood_visible || sassistfood_visible?'show':''}}" style="background-image: linear-gradient(90deg, rgba(0, 0, 0, 0.00), rgba(0, 0, 0, 0.00));" bindtap="hideModal">
  <text class="cuIcon-pullright"></text>
</view>

<scroll-view scroll-y class="DrawerWindow {{sseasoning_visible || sfood_visible || sassistfood_visible?'show':''}}" style="top:{{StatusBar+20}}px">
  <view class="cu-list menu card-menu margin-top-xl margin-bottom-xl shadow-lg">
      <block wx:if="{{sfood_visible}}">
    <view class="cu-bar search bg-white">
      <view class="search-form round">
        <text class="cuIcon-search"></text>
        <input type="text" placeholder="搜索主料" value="{{sfood_key}}" confirm-type="search" bindinput="searchFoodChange"></input>
      </view>
      <view class="action">
        <button class="cu-btn bg-red shadow-blur round">搜索</button>
      </view>
    </view>
    <view class="padding-sm flex flex-wrap" style="background-color: white;">
      <view class="padding-xs" wx:for="{{sfood_tag}}" wx:key="index" data-s="1" data-skey="{{item.key}}" bindtap="operateClickTag">
        <view class="cu-tag line-red">{{item.key}}</view>
      </view>
    </view>
    <block wx:for="{{sfood_list}}" wx:key="index">
      <view class="cu-item">
        <view class="content padding-tb-sm" bindtap="sfoodTap" data-row="{{item}}">
          <view>
            <view class="cu-avatar radius sm" style="background-image:url({{item.avatar}});"></view>
            <span style="margin-left: 20rpx;">{{item.cnname}}</span>
          </view>
          <view class="text-gray text-sm">
            <text class="cuIcon-infofill margin-right-xs"></text>
            {{item.infoc.desc}}
          </view>
        </view>
      </view>
    </block>
    <view wx:if="{{!sfood_list || sfood_list.length == 0}}" class="solid-bottom text-xs" style="text-align:center;margin-top: 60rpx;"><text class="text-gray">{{sfood_key && sfood_key.length>0?'橱柜无此食材':'输入名称搜索素材'}}</text></view>
    </block>

    <block wx:if="{{sassistfood_visible}}">
    <view class="cu-bar search bg-white">
      <view class="search-form round">
        <text class="cuIcon-search"></text>
        <input type="text" placeholder="搜索辅料" value="{{sassistfood_key}}" confirm-type="search" bindinput="searchAssistFoodChange"></input>
      </view>
      <view class="action">
        <button class="cu-btn bg-red shadow-blur round">搜索</button>
      </view>
    </view>
    <view class="padding-sm flex flex-wrap" style="background-color: white;">
      <view class="padding-xs" wx:for="{{sassistfood_tag}}" wx:key="index" data-s="3" data-skey="{{item.key}}" bindtap="operateClickTag">
        <view class="cu-tag line-red">{{item.key}}</view>
      </view>
    </view>
    <block wx:for="{{sassistfood_list}}" wx:key="index">
      <view class="cu-item">
        <view class="content padding-tb-sm" bindtap="sassistfoodTap" data-row="{{item}}">
          <view>
            <view class="cu-avatar radius sm" style="background-image:url({{item.avatar}});"></view>
            <span style="margin-left: 20rpx;">{{item.cnname}}</span>
          </view>
          <view class="text-gray text-sm">
            <text class="cuIcon-infofill margin-right-xs"></text>
            {{item.infoc.desc}}
          </view>
        </view>
      </view>
    </block>
    <view wx:if="{{!sassistfood_list || sassistfood_list.length == 0}}" class="solid-bottom text-xs" style="text-align:center;margin-top: 60rpx;"><text class="text-gray">{{sassistfood_key && sassistfood_key.length>0?'橱柜无此食材':'输入名称搜索素材'}}</text></view>
    </block>

<block wx:if="{{sseasoning_visible}}">
    <view class="cu-bar search bg-white">
      <view class="search-form round">
        <text class="cuIcon-search"></text>
        <input type="text" placeholder="搜索调味品" value="{{sseasoning_key}}" confirm-type="search" bindinput="searchSeasoningChange"></input>
      </view>
      <view class="action">
        <button class="cu-btn bg-red shadow-blur round">搜索</button>
      </view>
    </view>
    <view class="padding-sm flex flex-wrap" style="background-color: white;">
      <view class="padding-xs" wx:for="{{sseasoning_tag}}" wx:key="index" data-s="2" data-skey="{{item.key}}" bindtap="operateClickTag">
        <view class="cu-tag line-red">{{item.key}}</view>
      </view>
    </view>
    <block wx:for="{{sseasoning_list}}" wx:key="index">
      <view class="cu-item">
        <view class="content padding-tb-sm" bindtap="sseasoningTap" data-row="{{item}}">
          <view>
            <view class="cu-avatar radius sm" style="background-image:url({{item.avatar}});"></view>
            <span style="margin-left: 20rpx;">{{item.cnname}}</span>
          </view>
          <view class="text-gray text-sm">
            <text class="cuIcon-infofill margin-right-xs"></text>
            {{item.infoc.desc}}
          </view>
        </view>
      </view>
    </block>
    <view wx:if="{{!sseasoning_list || sseasoning_list.length == 0}}" class="solid-bottom text-xs" style="text-align:center;margin-top: 60rpx;"><text class="text-gray">{{sseasoning_key && sseasoning_key.length>0?'橱柜无此食材':'输入名称搜索素材'}}</text></view>
    </block>


  </view>
</scroll-view>
<tips id='tips'></tips>


<view class="cu-modal {{subDialog?'show':''}}">
  <view class="cu-dialog">
    <view class="padding-xl">
      <view class="cu-form-group">
		<view class="title">菜谱名称</view>
		<input placeholder="输入菜谱名称" value="{{pickname}}" bindinput="setpickname"></input>
	</view>
    </view>
    <view class="cu-bar bg-white justify-end">
      <view class="action">
        <button class="cu-btn line-green text-green" bindtap="hideDialog">取消</button>
        <button class="cu-btn bg-green margin-left" bindtap="subPick">确定</button>

      </view>
    </view>
  </view>
</view>





<!-- <footnav tabCur="{{2}}" /> -->