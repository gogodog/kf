<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yunchu.yapi.mapper.YcCookbookMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.yunchu.yapi.entity.YcCookbook">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <result column="img" property="img" />
        <result column="food" property="food" />
        <result column="assistfood" property="assistfood" />
        <result column="seasoning" property="seasoning" />
        <result column="attion" property="attion" />
        <result column="method" property="method" />
        <result column="miaoshu" property="miaoshu" />
        <result column="user_code" property="userCode" />
        <result column="user_wx_name" property="userWxName" />
        <result column="user_wx_head" property="userWxHead" />
        <result column="status" property="status" />
        <result column="create_time" property="createTime" />
        <result column="update_time" property="updateTime" />
        <result column="delete_flag" property="deleteFlag" />
    </resultMap>
    
    
    <resultMap id="streetListMap" type="com.yunchu.yapi.entity.YcCookbook">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <result column="img" property="img" />
        <result column="food" property="food" />
        <result column="assistfood" property="assistfood" />
        <result column="seasoning" property="seasoning" />
        <result column="attion" property="attion" />
        <result column="method" property="method" />
        <result column="miaoshu" property="miaoshu" />
        <result column="user_code" property="userCode" />
        <result column="user_wx_name" property="userWxName" />
        <result column="user_wx_head" property="userWxHead" />
        <result column="status" property="status" />
        <result column="create_time" property="createTime" />
        <result column="update_time" property="updateTime" />
        <result column="delete_flag" property="deleteFlag" />
        <collection property="tags" ofType="com.yunchu.yapi.entity.YcCookbookStyle">
            <id column="tag_id" property="id" />
	        <result column="tag_style_id" property="styleId" />
	        <result column="tag_style_enname" property="styleEnname" />
	        <result column="tag_style_cnname" property="styleCnname" />
	        <result column="tag_style_miaoshu" property="styleMiaoshu" />
	        <result column="tag_style_p_id" property="stylePId" />
        </collection>
    </resultMap>
    
    <resultMap id="streetListMapStep" type="com.yunchu.yapi.entity.YcCookbook">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <result column="img" property="img" />
        <result column="food" property="food" />
        <result column="assistfood" property="assistfood" />
        <result column="seasoning" property="seasoning" />
        <result column="attion" property="attion" />
        <result column="method" property="method" />
        <result column="miaoshu" property="miaoshu" />
        <result column="user_code" property="userCode" />
        <result column="user_wx_name" property="userWxName" />
        <result column="user_wx_head" property="userWxHead" />
        <result column="status" property="status" />
        <result column="create_time" property="createTime" />
        <result column="update_time" property="updateTime" />
        <result column="delete_flag" property="deleteFlag" />
        <association property="likeCount" javaType="java.lang.Long" select="com.yunchu.yapi.mapper.YcCookbookLikeMapper.getLikeCountByCookBookId" column="id"/>
        <association property="attionCount" javaType="java.lang.Long" select="com.yunchu.yapi.mapper.YcCookbookAttionMapper.getAttionCountByCookBookId" column="id"/>
        <collection property="tags" select="com.yunchu.yapi.mapper.YcCookbookStyleMapper.getTagsByCookBookId" column="id"></collection>
    </resultMap>
    
    <select id="streetList" resultMap="streetListMap">
        select yc_cookbook.*, 
        	tags.id as tag_id,
        	tags.style_id as tag_style_id,
        	tags.style_cnname as tag_style_cnname,
        	tags.style_enname as tag_style_enname,
        	tags.style_p_id as tag_style_p_id,
        	tags.style_miaoshu as tag_style_miaoshu
        from yc_cookbook left join yc_cookbook_style tags on yc_cookbook.id = tags.cookbook_id
    </select>
    
    <select id="streetListStep" resultMap="streetListMapStep">
        select 
        	*
        from yc_cookbook
        where status = 1
    </select>

</mapper>
